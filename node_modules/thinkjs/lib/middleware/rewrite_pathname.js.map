{"version":3,"sources":["../../src/middleware/rewrite_pathname.js"],"names":["run","http","pathname","prefix","config","indexOf","substr","length","suffix","think","middleware","base"],"mappings":"AAAA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKE;;;;mBAIAA,G,kBAAK;AACH,QAAIC,OAAO,KAAKA,IAAhB;AACA,QAAIC,WAAWD,KAAKC,QAApB;AACA,QAAI,CAACA,QAAD,IAAaA,aAAa,GAA9B,EAAmC;AACjC;AACD;AACD,QAAIC,SAASF,KAAKG,MAAL,CAAY,iBAAZ,CAAb;AACA,QAAID,UAAUD,SAASG,OAAT,CAAiBF,MAAjB,MAA6B,CAA3C,EAA8C;AAC5CD,iBAAWA,SAASI,MAAT,CAAgBH,OAAOI,MAAvB,CAAX;AACD;AACD,QAAIC,SAASP,KAAKG,MAAL,CAAY,iBAAZ,CAAb;AACA,QAAII,UAAUN,SAASI,MAAT,CAAgB,IAAIE,OAAOD,MAA3B,MAAuCC,MAArD,EAA6D;AAC3DN,iBAAWA,SAASI,MAAT,CAAgB,CAAhB,EAAmBJ,SAASK,MAAT,GAAkBC,OAAOD,MAA5C,CAAX;AACD;AACDN,SAAKC,QAAL,GAAgBA,QAAhB;AACD,G;;;EApB0BO,MAAMC,UAAN,CAAiBC,I","file":"rewrite_pathname.js","sourcesContent":["'use strict';\n/**\n * rewrite pathname\n * @type {}\n */\nexport default class extends think.middleware.base {\n  /**\n   * run\n   * @return {} []\n   */\n  run(){\n    let http = this.http;\n    let pathname = http.pathname;\n    if (!pathname || pathname === '/') {\n      return;\n    }\n    let prefix = http.config('pathname_prefix');\n    if (prefix && pathname.indexOf(prefix) === 0) {\n      pathname = pathname.substr(prefix.length);\n    }\n    let suffix = http.config('pathname_suffix');\n    if (suffix && pathname.substr(0 - suffix.length) === suffix) {\n      pathname = pathname.substr(0, pathname.length - suffix.length);\n    }\n    http.pathname = pathname;\n  }\n}"]}