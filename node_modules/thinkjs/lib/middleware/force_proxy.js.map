{"version":3,"sources":["../../src/middleware/force_proxy.js"],"names":["run","http","config","host","hostname","socket","error","Error","think","locale","statusAction","middleware","base"],"mappings":"AAAA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKE;;;;mBAIAA,G,kBAAK;AACH,QAAIC,OAAO,KAAKA,IAAhB;AACA;AACA,QAAI,KAAKC,MAAL,CAAY,UAAZ,KAA2BD,KAAKE,IAAL,KAAcF,KAAKG,QAA9C,IAA0D,CAACH,KAAKI,MAApE,EAA4E;AAC1EJ,WAAKK,KAAL,GAAa,IAAIC,KAAJ,CAAUC,MAAMC,MAAN,CAAa,eAAb,CAAV,CAAb;AACA,aAAOD,MAAME,YAAN,CAAmB,GAAnB,EAAwBT,IAAxB,CAAP;AACD;AACF,G;;;EAZ0BO,MAAMG,UAAN,CAAiBC,I","file":"force_proxy.js","sourcesContent":["'use strict';\n/**\n * force proxy\n * @type {}\n */\nexport default class extends think.middleware.base {\n  /**\n   * run\n   * @return {} []\n   */\n  run(){\n    let http = this.http;\n    //deny access by ip + port\n    if (this.config('proxy_on') && http.host !== http.hostname && !http.socket) {\n      http.error = new Error(think.locale('DISALLOW_PORT'));\n      return think.statusAction(403, http);\n    }\n  }\n}"]}